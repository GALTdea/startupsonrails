<div class="container mt-4">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h2 class="mb-0"><%= @company.name %>'s Open Source Projects</h2>
      <%= link_to "Add Project Support", 
          new_project_support_path(company_id: @company.id), 
          class: "btn btn-primary" %>
    </div>

    <div class="card-body">
      <div class="row">
        <!-- Sponsorships -->
        <div class="col-md-6 mb-4">
          <h3>Sponsorships</h3>
          <div class="list-group" id="sponsorship_supports">
            <% @project_supports.sponsorship.each do |support| %>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <%= link_to support.open_source_project.url, 
                      support.open_source_project.url, 
                      target: "_blank", 
                      class: "text-decoration-none" %>
                  <small class="text-muted d-block">
                    Added <%= time_ago_in_words(support.created_at) %> ago
                  </small>
                </div>
                <div>
                  <span class="badge bg-primary">Sponsor</span>
                  <% if current_user&.admin? || current_user == @company.user %>
                    <%= button_to project_support_path(support), 
                        method: :delete,
                        class: "btn btn-link text-danger p-0 ms-2",
                        form: { data: { turbo_confirm: "Are you sure?" } } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
          <% if @project_supports.sponsorship.empty? %>
            <p class="text-muted">No sponsored projects yet.</p>
          <% end %>
        </div>

        <!-- Contributions -->
        <div class="col-md-6 mb-4">
          <h3>Contributions</h3>
          <div class="list-group" id="contribution_supports">
            <% @project_supports.contribution.each do |support| %>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <%= link_to support.open_source_project.url, 
                      support.open_source_project.url, 
                      target: "_blank", 
                      class: "text-decoration-none" %>
                  <small class="text-muted d-block">
                    Added <%= time_ago_in_words(support.created_at) %> ago
                  </small>
                </div>
                <div>
                  <span class="badge bg-success">Contributor</span>
                  <% if current_user&.admin? || current_user == @company.user %>
                    <%= button_to project_support_path(support), 
                        method: :delete,
                        class: "btn btn-link text-danger p-0 ms-2",
                        form: { data: { turbo_confirm: "Are you sure?" } } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
          <% if @project_supports.contribution.empty? %>
            <p class="text-muted">No contributed projects yet.</p>
          <% end %>
        </div>
      </div>

      <div class="mt-4">
        <%#= link_to "Back to Company", admin_company_path(@company), class: "btn btn-secondary" %>
      </div>
    </div>
  </div>
</div>
